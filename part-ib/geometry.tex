\documentclass[main.tex]{subfiles}

\begin{document}
	\chapter{Geometry}
		\section{Surfaces}
		\begin{definition}[Continuity in metric space]
			A function $f\colon X \to Y$ is continuous at $P\in X$ if, for any $\varepsilon >0$, there exists $\delta > 0$ such that $d_X(Q, P) < \delta$ implies $d_Y(f(Q), f(P)) < \varepsilon$.
			
			This can be stated as, the inverse image of $B(f(P), \varepsilon)$ under $f$ contains $B(P, \delta)$. In other notation,
			\begin{equation*}
					B(P,\delta) \subseteq f\iv ``(B(f(P), \varepsilon)).
			\end{equation*}
		\end{definition}
		\begin{lemma}
			A map $f\colon X \to Y$ of metric spaces is continuous if and only if under $f$, the inverse image  of every open subset of $Y$ is open in $X$.
		\end{lemma}
		\begin{proof}
			The necessary condition is equivalent to that there exists an open neighbourhood for all point $P \in f\iv ``U$, i.e.
			\begin{equation*}
			(\forall P \in f\iv ``U)(\exists \delta > 0)[B(P, \delta) \subseteq f\iv ``U]
			\end{equation*}
			for any open set $U \subseteq Y$. By proving this for all point $P$, we can conclude that $f\iv `` U$ is open. 
			
			Since $f(P) \in U$ and $U$ is open, there exists a ball $B(f(P), \varepsilon) \subseteq U$ for some $\vep$. And since $f$ is continuous, there exists $\delta > 0$ such that
			\begin{equation*}
				B(P, \delta) \subseteq f\iv ``(B(f(P), \varepsilon)) \subseteq f\iv``U.
			\end{equation*} 
			The last inclusion follows from $B(f(P), \varepsilon) \subseteq U$.
			
			The sufficient condition is straightforward. For each $P \in X$ and $\vep > 0$, consider the image $f\iv ``(B(f(P), \vep))$ which maps to some open neighbourhood of $P$ by the hypothesis. It follows that there is $\delta >0$ so that $B(P,\delta) \subseteq f\iv ``(B(f(P), \varepsilon))$.
		\end{proof}
		This allows us to translate the idea of continuity to more general settings using open sets.
\end{document}